<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Google Site Verification --><meta name="google-site-verification" content="BrjL5fpoyHZu1rR8rwnnM2MBO3u3iIFB8NsmSuOsY84">
<title>Imputation of Missing Values • mlr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../jquery.sticky-kit.min.js"></script><script src="../../pkgdown.js"></script><link href="../../extra.css" rel="stylesheet">
<script src="../../extra.js"></script><meta property="og:title" content="Imputation of Missing Values">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
<link rel="icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
<link rel="apple-touch-icon" type="image/png" href="https://mlr-org.github.io/mlr/favicon.ico">
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../../index.html"></a>
      </div>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/task.html">Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learner.html">Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/train.html">Train</a>
    </li>
    <li>
      <a href="../../articles/tutorial/predict.html">Predict</a>
    </li>
    <li>
      <a href="../../articles/tutorial/preproc.html">Preprocessing</a>
    </li>
    <li>
      <a href="../../articles/tutorial/performance.html">Performance</a>
    </li>
    <li>
      <a href="../../articles/tutorial/resample.html">Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/tune.html">Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/benchmark_experiments.html">Benchmark Experiments</a>
    </li>
    <li>
      <a href="../../articles/tutorial/parallelization.html">Parallelization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/visualization.html">Visualization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/usecase_regression.html">Use case - Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/configureMlr.html">Configuration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/wrapper.html">Wrapped Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/impute.html">Imputation</a>
    </li>
    <li>
      <a href="../../articles/tutorial/bagging.html">Generic Bagging</a>
    </li>
    <li>
      <a href="../../articles/tutorial/advanced_tune.html">Advanced Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/feature_selection.html">Feature Selection/Filtering</a>
    </li>
    <li>
      <a href="../../articles/tutorial/nested_resampling.html">Nested Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/cost_sensitive_classif.html">Cost-Sensitive Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/over_and_undersampling.html">Imbalanced Classification Problems</a>
    </li>
    <li>
      <a href="../../articles/tutorial/roc_analysis.html">ROC Analysis and Performance Curves</a>
    </li>
    <li>
      <a href="../../articles/tutorial/multilabel.html">Multilabel Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learning_curve.html">Learning Curve Analysis</a>
    </li>
    <li>
      <a href="../../articles/tutorial/partial_dependence.html">Partial Dependence Plots</a>
    </li>
    <li>
      <a href="../../articles/tutorial/classifier_calibration.html">Classifier Calibration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/hyperpar_tuning_effects.html">Hyperparameter Tuning Effects</a>
    </li>
    <li>
      <a href="../../articles/tutorial/out_of_bag_predictions.html">Out-of-Bag Predictions</a>
    </li>
    <li>
      <a href="../../articles/tutorial/handling_of_spatial_data.html">Handling of Spatial Data</a>
    </li>
    <li>
      <a href="../../articles/tutorial/functional_data.html">Functional Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extending
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/create_learner.html">Create Custom Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_measure.html">Create Custom Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_imputation.html">Create Imputation Methods</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_filter.html">Create Custom Filters</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Appendix
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../reference/index.html">Function Reference</a>
    </li>
    <li>
      <a href="../../news/index.html">News</a>
    </li>
    <li>
      <a href="../../articles/tutorial/example_tasks.html">Example Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/integrated_learners.html">Integrated Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/measures.html">Implemented Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/filter_methods.html">Integrated Filter Methods</a>
    </li>
    <li>
      <a href="../../articles/tutorial/mlr_publications.html">mlr Publications</a>
    </li>
    <li>
      <a href="../../articles/tutorial/talks_videos_workshops.html">Talks, Videos and Workshops</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    mlr-org Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://github.com/mlr-org/mlrMBO">mlrMBO</a>
    </li>
    <li>
      <a href="https://github.com/mlr-org/mlrCPO">mlrCPO</a>
    </li>
    <li>
      <a href="https://jakob-r.de/mlrHyperopt/index.html">mlrHyperopt</a>
    </li>
    <li>
      <a href="https://openml.github.io/openml-r/vignettes/OpenML.html">OpenML</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mlr-org/mlr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.slack.com">
    <span class="fa fa-slack"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr">
    <span class="fa fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="search" class="form-control" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Imputation of Missing Values</h1>
            
      
      <!--The 'toc' block was inserted manually by @pat-s. It triggeres the inline ToC in the vignettes.-->
            <div id="toc">
      <h3 class="hasAnchor">
<a href="#toc" class="anchor"></a>Table of Contents</h3>
      <ul>
<li><a href="#imputation-and-reimputation">Imputation and reimputation</a></li>
      <li><a href="#fusing-a-learner-with-imputation">Fusing a learner with imputation</a></li>
      </ul>
</div>
      
      <small>Source: <a href="https://github.com/mlr-org/mlr/blob/master/vignettes/tutorial/impute.Rmd"><code>vignettes/tutorial/impute.Rmd</code></a></small>

    </div>

    
    
<div class="contents">
<p><code>mlr</code> provides several imputation methods which are listed on the help page <code><a href="../../reference/imputations.html">imputations()</a></code>. These include standard techniques as imputation by a constant value (like a fixed constant, the mean, median or mode) and random numbers (either from the empirical distribution of the feature under consideration or a certain distribution family). Moreover, missing values in one feature can be replaced based on the other features by predictions from any supervised Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) integrated into <code>mlr</code>.</p>
<p>If your favourite option is not implemented in <code>mlr</code> yet, you can easily create your own <a href="create_imputation.html" target="_blank">imputation method</a>.</p>
<p>Also note that some of the learning algorithms included in <code>mlr</code> can deal with missing values in a sensible way, i.e., other than simply deleting observations with missing values. Those Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>)s have the property <code>"missings"</code> and thus can be identified using <code><a href="../../reference/listLearners.html">listLearners()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Regression learners that can deal with missing values</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="../../reference/listLearners.html">listLearners</a></span>(<span class="st">"regr"</span>, <span class="dt">properties =</span> <span class="st">"missings"</span>)[<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"class"</span>, <span class="st">"package"</span>)]</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">## Warning in listLearners.character("regr", properties = "missings"): The following learners could not be constructed, probably because their packages are not installed:</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">## cluster.MiniBatchKmeans</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">## Check ?learners to see which packages you need or install mlr with all suggestions.</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">##              class     package</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">## 1 regr.bartMachine bartMachine</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">## 2     regr.cforest       party</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">## 3       regr.ctree       party</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">## 4      regr.cubist      Cubist</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">## 5 regr.featureless         mlr</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">## 6         regr.gbm         gbm</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">## ... (#rows: 13, #cols: 2)</span></span></code></pre></div>
<p>See also the list of <a href="integrated_learners.html" target="_blank">integrated learners</a> in the Appendix.</p>
<div id="imputation-and-reimputation" class="section level1">
<h1 class="hasAnchor">
<a href="#imputation-and-reimputation" class="anchor"></a>Imputation and reimputation</h1>
<p>Imputation can be done by function <code><a href="../../reference/impute.html">impute()</a></code>. You can specify an imputation method for each feature individually or for classes of features like numerics or factors. Moreover, you can generate dummy variables that indicate which values are missing, also either for classes of features or for individual features. These allow to identify the patterns and reasons for missing data and permit to treat imputed and observed values differently in a subsequent analysis.</p>
<p>Let’s have a look at the airquality (<code><a href="https://rdrr.io/r/datasets/airquality.html">datasets::airquality()</a></code>) data set.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(airquality)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(airquality)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">##      Ozone           Solar.R           Wind             Temp      </span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">##  Min.   :  1.00   Min.   :  7.0   Min.   : 1.700   Min.   :56.00  </span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">##  1st Qu.: 18.00   1st Qu.:115.8   1st Qu.: 7.400   1st Qu.:72.00  </span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">##  Median : 31.50   Median :205.0   Median : 9.700   Median :79.00  </span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">##  Mean   : 42.13   Mean   :185.9   Mean   : 9.958   Mean   :77.88  </span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">##  3rd Qu.: 63.25   3rd Qu.:258.8   3rd Qu.:11.500   3rd Qu.:85.00  </span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">##  Max.   :168.00   Max.   :334.0   Max.   :20.700   Max.   :97.00  </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">##  NA's   :37       NA's   :7                                       </span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">##      Month            Day      </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">##  Min.   :5.000   Min.   : 1.0  </span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">##  1st Qu.:6.000   1st Qu.: 8.0  </span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">##  Median :7.000   Median :16.0  </span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">##  Mean   :6.993   Mean   :15.8  </span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">##  3rd Qu.:8.000   3rd Qu.:23.0  </span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">##  Max.   :9.000   Max.   :31.0  </span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">## </span></span></code></pre></div>
<p>There are 37 <code>NA's</code> in variable <code>Ozone</code> (ozone pollution) and 7 <code>NA's</code> in variable <code>Solar.R</code> (solar radiation). For demonstration purposes we insert artificial <code>NA's</code> in column <code>Wind</code> (wind speed) and coerce it into a <code>factor</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>airq =<span class="st"> </span>airquality</span>
<span id="cb3-2"><a href="#cb3-2"></a>ind =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(airq), <span class="dv">10</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>airq<span class="op">$</span>Wind[ind] =<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>airq<span class="op">$</span>Wind =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(airq<span class="op">$</span>Wind, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">16</span>,<span class="dv">24</span>))</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(airq)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">##      Ozone           Solar.R           Wind         Temp      </span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">##  Min.   :  1.00   Min.   :  7.0   (0,8]  :51   Min.   :56.00  </span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">##  1st Qu.: 18.00   1st Qu.:115.8   (8,16] :85   1st Qu.:72.00  </span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">##  Median : 31.50   Median :205.0   (16,24]: 7   Median :79.00  </span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">##  Mean   : 42.13   Mean   :185.9   NA's   :10   Mean   :77.88  </span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">##  3rd Qu.: 63.25   3rd Qu.:258.8                3rd Qu.:85.00  </span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">##  Max.   :168.00   Max.   :334.0                Max.   :97.00  </span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">##  NA's   :37       NA's   :7                                   </span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">##      Month            Day      </span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">##  Min.   :5.000   Min.   : 1.0  </span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">##  1st Qu.:6.000   1st Qu.: 8.0  </span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">##  Median :7.000   Median :16.0  </span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">##  Mean   :6.993   Mean   :15.8  </span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">##  3rd Qu.:8.000   3rd Qu.:23.0  </span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">##  Max.   :9.000   Max.   :31.0  </span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">## </span></span></code></pre></div>
<p>If you want to impute <code>NA's</code> in all integer features (these include <code>Ozone</code> and <code>Solar.R</code>) by the mean, in all factor features (<code>Wind</code>) by the mode and additionally generate dummy variables for all integer features, you can do this as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>imp =<span class="st"> </span><span class="kw"><a href="../../reference/impute.html">impute</a></span>(airq, <span class="dt">classes =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">integer =</span> <span class="kw"><a href="../../reference/imputations.html">imputeMean</a></span>(), <span class="dt">factor =</span> <span class="kw"><a href="../../reference/imputations.html">imputeMode</a></span>()),</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="dt">dummy.classes =</span> <span class="st">"integer"</span>)</span></code></pre></div>
<p><code><a href="../../reference/impute.html">impute()</a></code> returns a <code>list</code> where slot <code>$data</code> contains the imputed data set. Per default, the dummy variables are factors with levels <code>"TRUE"</code> and <code>"FALSE"</code>. It is also possible to create numeric zero-one indicator variables.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(imp<span class="op">$</span>data, <span class="dv">10</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">##       Ozone  Solar.R    Wind Temp Month Day Ozone.dummy Solar.R.dummy</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">## 1  41.00000 190.0000   (0,8]   67     5   1       FALSE         FALSE</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">## 2  36.00000 118.0000   (0,8]   72     5   2       FALSE         FALSE</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">## 3  12.00000 149.0000  (8,16]   74     5   3       FALSE         FALSE</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">## 4  18.00000 313.0000  (8,16]   62     5   4       FALSE         FALSE</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">## 5  42.12931 185.9315  (8,16]   56     5   5        TRUE          TRUE</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">## 6  28.00000 185.9315  (8,16]   66     5   6       FALSE          TRUE</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">## 7  23.00000 299.0000  (8,16]   65     5   7       FALSE         FALSE</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">## 8  19.00000  99.0000  (8,16]   59     5   8       FALSE         FALSE</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">## 9   8.00000  19.0000 (16,24]   61     5   9       FALSE         FALSE</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">## 10 42.12931 194.0000  (8,16]   69     5  10        TRUE         FALSE</span></span></code></pre></div>
<p>Slot <code>$desc</code> is an <code>ImputationDesc</code> (<code><a href="../../reference/impute.html">impute()</a></code>) object that stores all relevant information about the imputation. For the current example this includes the means and the mode computed on the non-missing data.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>imp<span class="op">$</span>desc</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">## Imputation description</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">## Target: </span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">## Features: 6; Imputed: 6</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">## impute.new.levels: TRUE</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">## recode.factor.levels: TRUE</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">## dummy.type: factor</span></span></code></pre></div>
<p>The imputation description shows the name of the target variable (not present), the number of features and the number of imputed features. Note that the latter number refers to the features for which an imputation method was specified (five integers plus one factor) and not to the features actually containing <code>NA's</code>. <code>dummy.type</code> indicates that the dummy variables are factors. For details on <code>impute.new.levels</code> and <code>recode.factor.levels</code> see the help page of function <code><a href="../../reference/impute.html">impute()</a></code>.</p>
<p>Let’s have a look at another example involving a target variable. A possible learning task associated with the airquality (<code><a href="https://rdrr.io/r/datasets/airquality.html">datasets::airquality()</a></code>) data is to predict the ozone pollution based on the meteorological features. Since we do not want to use columns <code>Day</code> and <code>Month</code> we remove them.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>airq =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(airq, <span class="dt">select =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span></code></pre></div>
<p>The first 100 observations are used as training data set.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>airq.train =<span class="st"> </span>airq[<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,]</span>
<span id="cb8-2"><a href="#cb8-2"></a>airq.test =<span class="st"> </span>airq[<span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>),]</span></code></pre></div>
<p>In case of a supervised learning problem you need to pass the name of the target variable to <code><a href="../../reference/impute.html">impute()</a></code>. This prevents imputation and creation of a dummy variable for the target variable itself and makes sure that the target variable is not used to impute the features.</p>
<p>In contrast to the example above we specify imputation methods for individual features instead of classes of features.</p>
<p>Missing values in <code>Solar.R</code> are imputed by random numbers drawn from the empirical distribution of the non-missing observations.</p>
<p>Function <code>imputeLearner</code> (<code><a href="../../reference/imputations.html">imputations()</a></code>) allows to use all supervised learning algorithms integrated into <code>mlr</code> for imputation. The type of the Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) (<code>regr</code>, <code>classif</code>) must correspond to the class of the feature to be imputed. The missing values in <code>Wind</code> are replaced by the predictions of a classification tree (<code><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart::rpart()</a></code>). Per default, all available columns in <code>airq.train</code> except the target variable (<code>Ozone</code>) and the variable to be imputed (<code>Wind</code>) are used as features in the classification tree, here <code>Solar.R</code> and <code>Temp</code>. You can also select manually which columns to use. Note that <code><a href="https://rdrr.io/pkg/rpart/man/rpart.html">rpart::rpart()</a></code> can deal with missing feature values, therefore the <code>NA's</code> in column <code>Solar.R</code> do not pose a problem.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>imp =<span class="st"> </span><span class="kw"><a href="../../reference/impute.html">impute</a></span>(airq.train, <span class="dt">target =</span> <span class="st">"Ozone"</span>, <span class="dt">cols =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">Solar.R =</span> <span class="kw"><a href="../../reference/imputations.html">imputeHist</a></span>(),</span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="dt">Wind =</span> <span class="kw"><a href="../../reference/imputations.html">imputeLearner</a></span>(<span class="st">"classif.rpart"</span>)), <span class="dt">dummy.cols =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Solar.R"</span>, <span class="st">"Wind"</span>))</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(imp<span class="op">$</span>data)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">##      Ozone           Solar.R           Wind         Temp      </span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">##  Min.   :  1.00   Min.   :  7.0   (0,8]  :35   Min.   :56.00  </span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">##  1st Qu.: 16.00   1st Qu.:100.5   (8,16] :59   1st Qu.:69.00  </span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">##  Median : 34.00   Median :223.0   (16,24]: 6   Median :79.50  </span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">##  Mean   : 41.59   Mean   :192.0                Mean   :76.87  </span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">##  3rd Qu.: 63.00   3rd Qu.:273.2                3rd Qu.:84.00  </span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">##  Max.   :135.00   Max.   :334.0                Max.   :93.00  </span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">##  NA's   :31                                                   </span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">##  Solar.R.dummy Wind.dummy</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">##  FALSE:93      FALSE:94  </span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">##  TRUE : 7      TRUE : 6  </span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">##                          </span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">##                          </span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">##                          </span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">##                          </span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">## </span></span>
<span id="cb9-20"><a href="#cb9-20"></a></span>
<span id="cb9-21"><a href="#cb9-21"></a>imp<span class="op">$</span>desc</span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">## Imputation description</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">## Target: Ozone</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">## Features: 3; Imputed: 2</span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">## impute.new.levels: TRUE</span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">## recode.factor.levels: TRUE</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">## dummy.type: factor</span></span></code></pre></div>
<p>The <code>ImputationDesc</code> (<code><a href="../../reference/impute.html">impute()</a></code>) object can be used by function <code><a href="../../reference/reimpute.html">reimpute()</a></code> to impute the test data set the same way as the training data.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>airq.test.imp =<span class="st"> </span><span class="kw"><a href="../../reference/reimpute.html">reimpute</a></span>(airq.test, imp<span class="op">$</span>desc)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(airq.test.imp)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">##   Ozone Solar.R   Wind Temp Solar.R.dummy Wind.dummy</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">## 1   110     207  (0,8]   90         FALSE      FALSE</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">## 2    NA     222 (8,16]   92         FALSE      FALSE</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">## 3    NA     137 (8,16]   86         FALSE      FALSE</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">## 4    44     192 (8,16]   86         FALSE      FALSE</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">## 5    28     273 (8,16]   82         FALSE      FALSE</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">## 6    65     157 (8,16]   80         FALSE      FALSE</span></span></code></pre></div>
<p>Especially when evaluating a machine learning method by some resampling technique you might want that <code><a href="../../reference/impute.html">impute()</a></code>/<code><a href="../../reference/reimpute.html">reimpute()</a></code> are called automatically each time before training/prediction. This can be achieved by creating an imputation wrapper.</p>
</div>
<div id="fusing-a-learner-with-imputation" class="section level1">
<h1 class="hasAnchor">
<a href="#fusing-a-learner-with-imputation" class="anchor"></a>Fusing a learner with imputation</h1>
<p>You can couple a Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) with imputation by function <code><a href="../../reference/makeImputeWrapper.html">makeImputeWrapper()</a></code> which basically has the same formal arguments as <code><a href="../../reference/impute.html">impute()</a></code>. Like in the example above we impute <code>Solar.R</code> by random numbers from its empirical distribution, <code>Wind</code> by the predictions of a classification tree and generate dummy variables for both features.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeImputeWrapper.html">makeImputeWrapper</a></span>(<span class="st">"regr.lm"</span>, <span class="dt">cols =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">Solar.R =</span> <span class="kw"><a href="../../reference/imputations.html">imputeHist</a></span>(),</span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="dt">Wind =</span> <span class="kw"><a href="../../reference/imputations.html">imputeLearner</a></span>(<span class="st">"classif.rpart"</span>)), <span class="dt">dummy.cols =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Solar.R"</span>, <span class="st">"Wind"</span>))</span>
<span id="cb11-3"><a href="#cb11-3"></a>lrn</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">## Learner regr.lm.imputed from package stats</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">## Type: regr</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">## Name: ; Short name: </span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">## Class: ImputeWrapper</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">## Properties: numerics,factors,se,weights,missings</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">## Predict-Type: response</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">## Hyperparameters:</span></span></code></pre></div>
<p>Before training the resulting Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>), <code><a href="../../reference/impute.html">impute()</a></code> is applied to the training set. Before prediction <code><a href="../../reference/reimpute.html">reimpute()</a></code> is called on the test set and the <code>ImputationDesc</code> (<code><a href="../../reference/impute.html">impute()</a></code>) object from the training stage.</p>
<p>We again aim to predict the ozone pollution from the meteorological variables. In order to create the <code><a href="../../reference/Task.html">Task()</a></code> we need to delete observations with missing values in the target variable.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>airq =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/subset.html">subset</a></span>(airq, <span class="dt">subset =</span> <span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(airq<span class="op">$</span>Ozone))</span>
<span id="cb12-2"><a href="#cb12-2"></a>task =<span class="st"> </span><span class="kw"><a href="../../reference/RegrTask.html">makeRegrTask</a></span>(<span class="dt">data =</span> airq, <span class="dt">target =</span> <span class="st">"Ozone"</span>)</span></code></pre></div>
<p>In the following the 3-fold cross-validated <a href="measures.html" target="_blank">mean squared error</a> is calculated.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>rdesc =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(lrn, task, <span class="dt">resampling =</span> rdesc, <span class="dt">show.info =</span> <span class="ot">FALSE</span>, <span class="dt">models =</span> <span class="ot">TRUE</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a>r<span class="op">$</span>aggr</span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">## mse.test.mean </span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">##      483.2621</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(r<span class="op">$</span>models, getLearnerModel, <span class="dt">more.unwrap =</span> <span class="ot">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">## [[1]]</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">## </span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">## Call:</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">## stats::lm(formula = f, data = d)</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">## </span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">## Coefficients:</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">##       (Intercept)            Solar.R         Wind(8,16]  </span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">##         -72.62255            0.05914          -27.65865  </span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">##       Wind(16,24]               Temp  Solar.R.dummyTRUE  </span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">##         -27.50254            1.58889           -9.24041  </span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">##    Wind.dummyTRUE  </span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="co">##           1.45173  </span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="co">## </span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="co">## </span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co">## [[2]]</span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co">## </span></span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="co">## Call:</span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="co">## stats::lm(formula = f, data = d)</span></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co">## </span></span>
<span id="cb14-21"><a href="#cb14-21"></a><span class="co">## Coefficients:</span></span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="co">##       (Intercept)            Solar.R         Wind(8,16]  </span></span>
<span id="cb14-23"><a href="#cb14-23"></a><span class="co">##        -118.37366            0.07683          -18.92091  </span></span>
<span id="cb14-24"><a href="#cb14-24"></a><span class="co">##       Wind(16,24]               Temp  Solar.R.dummyTRUE  </span></span>
<span id="cb14-25"><a href="#cb14-25"></a><span class="co">##          -1.82817            2.01424           -7.18644  </span></span>
<span id="cb14-26"><a href="#cb14-26"></a><span class="co">##    Wind.dummyTRUE  </span></span>
<span id="cb14-27"><a href="#cb14-27"></a><span class="co">##         -14.57578  </span></span>
<span id="cb14-28"><a href="#cb14-28"></a><span class="co">## </span></span>
<span id="cb14-29"><a href="#cb14-29"></a><span class="co">## </span></span>
<span id="cb14-30"><a href="#cb14-30"></a><span class="co">## [[3]]</span></span>
<span id="cb14-31"><a href="#cb14-31"></a><span class="co">## </span></span>
<span id="cb14-32"><a href="#cb14-32"></a><span class="co">## Call:</span></span>
<span id="cb14-33"><a href="#cb14-33"></a><span class="co">## stats::lm(formula = f, data = d)</span></span>
<span id="cb14-34"><a href="#cb14-34"></a><span class="co">## </span></span>
<span id="cb14-35"><a href="#cb14-35"></a><span class="co">## Coefficients:</span></span>
<span id="cb14-36"><a href="#cb14-36"></a><span class="co">##       (Intercept)            Solar.R         Wind(8,16]  </span></span>
<span id="cb14-37"><a href="#cb14-37"></a><span class="co">##         -93.94976            0.06823          -20.38373  </span></span>
<span id="cb14-38"><a href="#cb14-38"></a><span class="co">##       Wind(16,24]               Temp  Solar.R.dummyTRUE  </span></span>
<span id="cb14-39"><a href="#cb14-39"></a><span class="co">##         -17.85132            1.75427          -17.09540  </span></span>
<span id="cb14-40"><a href="#cb14-40"></a><span class="co">##    Wind.dummyTRUE  </span></span>
<span id="cb14-41"><a href="#cb14-41"></a><span class="co">##           1.37333</span></span></code></pre></div>
<p>A second possibility to fuse a learner with imputation is provided by <code><a href="../../reference/makePreprocWrapperCaret.html">makePreprocWrapperCaret()</a></code>, which is an interface to <code>caret</code>s <code><a href="https://rdrr.io/pkg/caret/man/preProcess.html">caret::preProcess()</a></code> function. <code><a href="https://rdrr.io/pkg/caret/man/preProcess.html">caret::preProcess()</a></code> only works for numeric features and offers imputation by k-nearest neighbors, bagged trees, and by the median.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#imputation-and-reimputation">Imputation and reimputation</a></li>
      <li><a href="#fusing-a-learner-with-imputation">Fusing a learner with imputation</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><!--<div class="copyright">
  <p>Developed by Bernd Bischl, Michel Lang, Lars Kotthoff, Julia Schiffner, Jakob Richter, Zachary Jones, Giuseppe Casalicchio, Mason Gallo, Patrick Schratz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>
--></footer>
</div>

   <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script><script type="text/javascript"> docsearch({
 apiKey: 'e300ecafdf04fe1199e3339c825ce7d0',
 indexName: 'mlr',
 inputSelector: 'input#search-input.form-control',
 debug: false // Set debug to true if you want to inspect the dropdown
});
</script>
</body>
</html>
